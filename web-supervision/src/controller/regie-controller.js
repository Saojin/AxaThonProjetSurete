'use strict';
var AxaSafeControllers;
(function (AxaSafeControllers) {
    var RegieCtrl = (function () {
        RegieCtrl.$inject = ["$scope", "uiGmapGoogleMapApi", "RegieService", "UserService", "$interval"];
        function RegieCtrl($scope, uiGmapGoogleMapApi, RegieService, UserService, $interval) {
            'ngInject';
            var _this = this;
            this.$scope = $scope;
            this.RegieService = RegieService;
            this.UserService = UserService;
            this.fk = {};
            this.isLoading = true;
            uiGmapGoogleMapApi.then(function (maps) {
                if (typeof _.contains === 'undefined') {
                    _.contains = _.includes;
                }
                if (typeof _.object === 'undefined') {
                    _.object = _.zipObject;
                }
                maps.visualRefresh = true;
                RegieService.getPositions().then(function (response) {
                    _this.fk.data1 = Math.ceil(Math.random() * 234);
                    _this.fk.data2 = Math.ceil(Math.random() * 932);
                    _this.fk.data3 = Math.ceil(Math.random() * 534);
                    _this.fk.data4 = Math.ceil(Math.random() * 16);
                    _this.isLoading = false;
                    response.data.forEach(function (signalement) {
                        if (!signalement.hasMeta)
                            signalement.icon = 'src/img/no-info.png';
                        else
                            signalement.icon = 'src/img/info.png';
                        signalement.click = function () {
                            if (!!signalement.hasMeta)
                                _this.showDetails(signalement);
                            else
                                _this.currentPoint = null;
                        };
                        _this.map.pointList.push(signalement);
                    });
                    $interval(function () {
                        _this.fk.data1 = Math.ceil(Math.random() * 234);
                    }, 1000 + Math.random() * 2500);
                    $interval(function () {
                        _this.fk.data2 = Math.ceil(Math.random() * 932);
                    }, 1000 + Math.random() * 2500);
                    $interval(function () {
                        _this.fk.data3 = Math.ceil(Math.random() * 534);
                    }, 1000 + Math.random() * 2500);
                    $interval(function () {
                        _this.fk.data4 = Math.ceil(Math.random() * 16);
                    }, 1000 + Math.random() * 2500);
                });
            });
            this.map = { center: { latitude: 48.8965812, longitude: 2.318375999999944 }, zoom: 13, pointList: [], options: { streetViewControl: false } };
            RegieService.socket.on('nouveau-signalement', function (signalement) {
                signalement.options = { animation: 2 };
                if (!signalement.hasMeta)
                    signalement.icon = 'src/img/no-info.png';
                else
                    signalement.icon = 'src/img/info.png';
                signalement.click = function () {
                    if (!!signalement.hasMeta)
                        _this.showDetails(signalement);
                    else
                        _this.currentPoint = null;
                };
                _this.map.pointList.push(signalement);
                _this.$scope.$apply();
            });
        }
        RegieCtrl.prototype.showDetails = function (point) {
            var _this = this;
            this.isLoading = true;
            this.currentPoint = null;
            this.RegieService.resource().get({ id: point.id }).$promise.then(function (data) {
                _this.UserService.get({ id: data.userid }).$promise.then(function (userData) {
                    data.utilisateur = userData;
                    _this.currentPoint = data;
                    _this.isLoading = false;
                    console.log(_this.currentPoint);
                }, function () {
                    _this.currentPoint = data;
                    _this.isLoading = false;
                });
            });
            this.$scope.$apply();
        };
        return RegieCtrl;
    }());
    AxaSafeControllers.RegieCtrl = RegieCtrl;
})(AxaSafeControllers || (AxaSafeControllers = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jb250cm9sbGVyL3JlZ2llLWNvbnRyb2xsZXIudHMiLCJzcmMvY29udHJvbGxlci9yZWdpZS1jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBO0FBSUEsSUFBTztBQUFQLENBQUEsVUFBTyxvQkFBbUI7OzhHQUN4QixJQUFBLGFBQUEsWUFBQTtRQU9NLFNBQUEsVUFBbUIsUUFBa0Isb0JBQStCLGNBQXlCLGFBQWlCLFdBQWE7WUFDdkg7WUFSVixJQUFBLFFBQUE7WUFPeUIsS0FBQSxTQUFBO1lBQWlELEtBQUEsZUFBQTtZQUF5QixLQUFBLGNBQUE7WUFIdEYsS0FBQSxLQUFTO1lBQ1QsS0FBQSxZQUFvQjtZQUt2QixtQkFBbUIsS0FBSyxVQUFDLE1BQVE7Z0JBRTdCLElBQUksT0FBTyxFQUFFLGFBQWEsYUFBYztvQkFDcEMsRUFBRSxXQUFXLEVBQUU7O2dCQUVuQixJQUFJLE9BQU8sRUFBRSxXQUFXLGFBQWM7b0JBQ2xDLEVBQUUsU0FBUyxFQUFFOztnQkFFaEIsS0FBSyxnQkFBZ0I7Z0JBRXJCLGFBQWEsZUFBZSxLQUFLLFVBQUMsVUFBWTtvQkFDMUMsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUztvQkFDeEMsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUztvQkFDeEMsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUztvQkFDeEMsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUztvQkFDdkMsTUFBSyxZQUFZO29CQUVqQixTQUFTLEtBQUssUUFBUSxVQUFDLGFBQWU7d0JBQ2xDLElBQUcsQ0FBQyxZQUFZOzRCQUN0QixZQUFZLE9BQU87OzRCQUVuQixZQUFZLE9BQU87d0JBRWIsWUFBWSxRQUFTLFlBQUE7NEJBQ2pCLElBQUcsQ0FBQyxDQUFDLFlBQVk7Z0NBQ2pCLE1BQUssWUFBWTs7Z0NBRWpCLE1BQUssZUFBZTs7d0JBRXhCLE1BQUssSUFBSSxVQUFVLEtBQUs7O29CQUU3QixVQUFVLFlBQUE7d0JBQ1IsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUzt1QkFDdkMsT0FBTyxLQUFLLFdBQVc7b0JBQzFCLFVBQVUsWUFBQTt3QkFDUixNQUFLLEdBQUcsUUFBUSxLQUFLLEtBQUssS0FBSyxXQUFTO3VCQUN2QyxPQUFPLEtBQUssV0FBVztvQkFDMUIsVUFBVSxZQUFBO3dCQUNSLE1BQUssR0FBRyxRQUFRLEtBQUssS0FBSyxLQUFLLFdBQVM7dUJBQ3ZDLE9BQU8sS0FBSyxXQUFXO29CQUMxQixVQUFVLFlBQUE7d0JBQ1IsTUFBSyxHQUFHLFFBQVEsS0FBSyxLQUFLLEtBQUssV0FBUzt1QkFDdkMsT0FBTyxLQUFLLFdBQVc7OztZQUluQyxLQUFLLE1BQU8sRUFBQyxRQUFRLEVBQUUsVUFBVSxZQUFZLFdBQVcscUJBQXFCLE1BQU0sSUFBSSxXQUFXLElBQUksU0FBUyxFQUFDLG1CQUFtQjtZQUduSSxhQUFhLE9BQU8sR0FBRyx1QkFBdUIsVUFBQyxhQUFlO2dCQUM1RCxZQUFZLFVBQVUsRUFBQyxXQUFXO2dCQUNoQyxJQUFHLENBQUMsWUFBWTtvQkFDWixZQUFZLE9BQU87O29CQUVuQixZQUFZLE9BQU87Z0JBRXRCLFlBQVksUUFBUyxZQUFBO29CQUNoQixJQUFHLENBQUMsQ0FBQyxZQUFZO3dCQUNULE1BQUssWUFBWTs7d0JBRWpCLE1BQUssZUFBZTs7Z0JBRXBDLE1BQUssSUFBSSxVQUFVLEtBQUs7Z0JBQ3hCLE1BQUssT0FBTzs7O1FBSWxCLFVBQUEsVUFBQSxjQUFBLFVBQVksT0FBUztZQUFyQixJQUFBLFFBQUE7WUFDRSxLQUFLLFlBQVk7WUFDakIsS0FBSyxlQUFlO1lBQ3BCLEtBQUssYUFBYSxXQUFXLElBQUksRUFBQyxJQUFJLE1BQU0sTUFBSyxTQUFTLEtBQUssVUFBQyxNQUFRO2dCQUN0RSxNQUFLLFlBQVksSUFBSSxFQUFDLElBQUksS0FBSyxVQUFTLFNBQVMsS0FBSyxVQUFDLFVBQVk7b0JBQ2pFLEtBQUssY0FBYztvQkFDbkIsTUFBSyxlQUFlO29CQUNwQixNQUFLLFlBQVk7b0JBQ2pCLFFBQVEsSUFBSSxNQUFLO21CQUNqQixZQUFBO29CQUFNLE1BQUssZUFBZTtvQkFDMUIsTUFBSyxZQUFZOzs7WUFFckIsS0FBSyxPQUFPOztRQUVsQixPQUFBOztJQTNGVyxtQkFBQSxZQUFTO0dBRGpCLHVCQUFBLHFCQUFrQjtBQ3FGekIiLCJmaWxlIjoic3JjL2NvbnRyb2xsZXIvcmVnaWUtY29udHJvbGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi90eXBpbmdzL3RzZC5kLnRzXCIgLz5cblxuJ3VzZSBzdHJpY3QnO1xuXG5kZWNsYXJlIHZhciBfOmFueTsgLy8gaGFja3kgaGFja3kgXl5cblxubW9kdWxlIEF4YVNhZmVDb250cm9sbGVycyB7XG4gIGV4cG9ydCBjbGFzcyBSZWdpZUN0cmwge1xuICAgICAgICBcbiAgICAgICAgcHVibGljIGN1cnJlbnRQb2ludDphbnk7XG4gICAgICAgIHB1YmxpYyBtYXA6YW55O1xuICAgICAgICBwdWJsaWMgZms6YW55ID0ge307XG4gICAgICAgIHB1YmxpYyBpc0xvYWRpbmc6Ym9vbGVhbiA9IHRydWU7XG5cbiAgICAgICAgY29uc3RydWN0b3IocHVibGljICRzY29wZTpuZy5JU2NvcGUsIHVpR21hcEdvb2dsZU1hcEFwaTphbnksIHB1YmxpYyBSZWdpZVNlcnZpY2U6YW55LCBwdWJsaWMgVXNlclNlcnZpY2U6YW55LCAkaW50ZXJ2YWw6YW55KSB7XG4gICAgICAgICAgICAnbmdJbmplY3QnO1xuXG4gICAgICAgICAgICB1aUdtYXBHb29nbGVNYXBBcGkudGhlbigobWFwczphbnkpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBsb2Rhc2ggZXN0IHDDqXTDqVxuICAgICAgICAgICAgICAgIGlmKCB0eXBlb2YgXy5jb250YWlucyA9PT0gJ3VuZGVmaW5lZCcgKSB7XG4gICAgICAgICAgICAgICAgICAgIF8uY29udGFpbnMgPSBfLmluY2x1ZGVzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiggdHlwZW9mIF8ub2JqZWN0ID09PSAndW5kZWZpbmVkJyApIHtcbiAgICAgICAgICAgICAgICAgICAgXy5vYmplY3QgPSBfLnppcE9iamVjdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgIG1hcHMudmlzdWFsUmVmcmVzaCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgUmVnaWVTZXJ2aWNlLmdldFBvc2l0aW9ucygpLnRoZW4oKHJlc3BvbnNlOmFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhMSA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjIzNCk7XG4gICAgICAgICAgICAgICAgICAgICB0aGlzLmZrLmRhdGEyID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkqOTMyKTtcbiAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmsuZGF0YTMgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSo1MzQpO1xuICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhNCA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjE2KTtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuZGF0YS5mb3JFYWNoKChzaWduYWxlbWVudDphbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXNpZ25hbGVtZW50Lmhhc01ldGEpXG4gICAgICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50Lmljb24gPSAnc3JjL2ltZy9uby1pbmZvLnBuZyc7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgc2lnbmFsZW1lbnQuaWNvbiA9ICdzcmMvaW1nL2luZm8ucG5nJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmFsZW1lbnQuY2xpY2sgPSAgKCk9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighIXNpZ25hbGVtZW50Lmhhc01ldGEpICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEZXRhaWxzKHNpZ25hbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXAucG9pbnRMaXN0LnB1c2goc2lnbmFsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgJGludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhMSA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjIzNCk7XG4gICAgICAgICAgICAgICAgICAgICB9LCAxMDAwICsgTWF0aC5yYW5kb20oKSAqIDI1MDApO1xuICAgICAgICAgICAgICAgICAgICAgJGludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhMiA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjkzMik7XG4gICAgICAgICAgICAgICAgICAgICB9LCAxMDAwICsgTWF0aC5yYW5kb20oKSAqIDI1MDApO1xuICAgICAgICAgICAgICAgICAgICAgJGludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhMyA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjUzNCk7XG4gICAgICAgICAgICAgICAgICAgICB9LCAxMDAwICsgTWF0aC5yYW5kb20oKSAqIDI1MDApO1xuICAgICAgICAgICAgICAgICAgICAgJGludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5may5kYXRhNCA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjE2KTtcbiAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDAgKyBNYXRoLnJhbmRvbSgpICogMjUwMCk7XG4gICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMubWFwID0gIHtjZW50ZXI6IHsgbGF0aXR1ZGU6IDQ4Ljg5NjU4MTIsIGxvbmdpdHVkZTogMi4zMTgzNzU5OTk5OTk5NDQgfSwgem9vbTogMTMsIHBvaW50TGlzdDogW10sIG9wdGlvbnM6IHtzdHJlZXRWaWV3Q29udHJvbDogZmFsc2V9fTtcbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgICBSZWdpZVNlcnZpY2Uuc29ja2V0Lm9uKCdub3V2ZWF1LXNpZ25hbGVtZW50JywgKHNpZ25hbGVtZW50OmFueSkgPT4ge1xuICAgICAgICAgICAgICBzaWduYWxlbWVudC5vcHRpb25zID0ge2FuaW1hdGlvbjogMn07XG4gICAgICAgICAgICAgICAgaWYoIXNpZ25hbGVtZW50Lmhhc01ldGEpXG4gICAgICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50Lmljb24gPSAnc3JjL2ltZy9uby1pbmZvLnBuZyc7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgc2lnbmFsZW1lbnQuaWNvbiA9ICdzcmMvaW1nL2luZm8ucG5nJztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50LmNsaWNrID0gICgpPT4geyAgIFxuICAgICAgICAgICAgICAgICAgICAgIGlmKCEhc2lnbmFsZW1lbnQuaGFzTWV0YSkgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RldGFpbHMoc2lnbmFsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQgPSBudWxsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdGhpcy5tYXAucG9pbnRMaXN0LnB1c2goc2lnbmFsZW1lbnQpO1xuICAgICAgICAgICAgICB0aGlzLiRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzaG93RGV0YWlscyhwb2ludDphbnkpIHtcbiAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQgPSBudWxsO1xuICAgICAgICAgIHRoaXMuUmVnaWVTZXJ2aWNlLnJlc291cmNlKCkuZ2V0KHtpZDogcG9pbnQuaWR9KS4kcHJvbWlzZS50aGVuKChkYXRhOmFueSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5Vc2VyU2VydmljZS5nZXQoe2lkOiBkYXRhLnVzZXJpZH0pLiRwcm9taXNlLnRoZW4oKHVzZXJEYXRhOmFueSkgPT4ge1xuICAgICAgICAgICAgICBkYXRhLnV0aWxpc2F0ZXVyID0gdXNlckRhdGE7XG4gICAgICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50ID0gZGF0YTtcbiAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5jdXJyZW50UG9pbnQpO1xuICAgICAgICAgICAgfSwoKT0+eyB0aGlzLmN1cnJlbnRQb2ludCA9IGRhdGE7XG4gICAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7fSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy4kc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG52YXIgQXhhU2FmZUNvbnRyb2xsZXJzO1xuKGZ1bmN0aW9uIChBeGFTYWZlQ29udHJvbGxlcnMpIHtcbiAgICB2YXIgUmVnaWVDdHJsID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUmVnaWVDdHJsKCRzY29wZSwgdWlHbWFwR29vZ2xlTWFwQXBpLCBSZWdpZVNlcnZpY2UsIFVzZXJTZXJ2aWNlLCAkaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICduZ0luamVjdCc7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy4kc2NvcGUgPSAkc2NvcGU7XG4gICAgICAgICAgICB0aGlzLlJlZ2llU2VydmljZSA9IFJlZ2llU2VydmljZTtcbiAgICAgICAgICAgIHRoaXMuVXNlclNlcnZpY2UgPSBVc2VyU2VydmljZTtcbiAgICAgICAgICAgIHRoaXMuZmsgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHVpR21hcEdvb2dsZU1hcEFwaS50aGVuKGZ1bmN0aW9uIChtYXBzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBfLmNvbnRhaW5zID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBfLmNvbnRhaW5zID0gXy5pbmNsdWRlcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBfLm9iamVjdCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgXy5vYmplY3QgPSBfLnppcE9iamVjdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWFwcy52aXN1YWxSZWZyZXNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBSZWdpZVNlcnZpY2UuZ2V0UG9zaXRpb25zKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmsuZGF0YTEgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDIzNCk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZrLmRhdGEyID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiA5MzIpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5may5kYXRhMyA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogNTM0KTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmsuZGF0YTQgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmRhdGEuZm9yRWFjaChmdW5jdGlvbiAoc2lnbmFsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2lnbmFsZW1lbnQuaGFzTWV0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWduYWxlbWVudC5pY29uID0gJ3NyYy9pbWcvbm8taW5mby5wbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50Lmljb24gPSAnc3JjL2ltZy9pbmZvLnBuZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduYWxlbWVudC5jbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFzaWduYWxlbWVudC5oYXNNZXRhKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93RGV0YWlscyhzaWduYWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jdXJyZW50UG9pbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm1hcC5wb2ludExpc3QucHVzaChzaWduYWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmsuZGF0YTEgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDIzNCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMDAgKyBNYXRoLnJhbmRvbSgpICogMjUwMCk7XG4gICAgICAgICAgICAgICAgICAgICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5may5kYXRhMiA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogOTMyKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCArIE1hdGgucmFuZG9tKCkgKiAyNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZrLmRhdGEzID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiA1MzQpO1xuICAgICAgICAgICAgICAgICAgICB9LCAxMDAwICsgTWF0aC5yYW5kb20oKSAqIDI1MDApO1xuICAgICAgICAgICAgICAgICAgICAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmsuZGF0YTQgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCArIE1hdGgucmFuZG9tKCkgKiAyNTAwKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5tYXAgPSB7IGNlbnRlcjogeyBsYXRpdHVkZTogNDguODk2NTgxMiwgbG9uZ2l0dWRlOiAyLjMxODM3NTk5OTk5OTk0NCB9LCB6b29tOiAxMywgcG9pbnRMaXN0OiBbXSwgb3B0aW9uczogeyBzdHJlZXRWaWV3Q29udHJvbDogZmFsc2UgfSB9O1xuICAgICAgICAgICAgUmVnaWVTZXJ2aWNlLnNvY2tldC5vbignbm91dmVhdS1zaWduYWxlbWVudCcsIGZ1bmN0aW9uIChzaWduYWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50Lm9wdGlvbnMgPSB7IGFuaW1hdGlvbjogMiB9O1xuICAgICAgICAgICAgICAgIGlmICghc2lnbmFsZW1lbnQuaGFzTWV0YSlcbiAgICAgICAgICAgICAgICAgICAgc2lnbmFsZW1lbnQuaWNvbiA9ICdzcmMvaW1nL25vLWluZm8ucG5nJztcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHNpZ25hbGVtZW50Lmljb24gPSAnc3JjL2ltZy9pbmZvLnBuZyc7XG4gICAgICAgICAgICAgICAgc2lnbmFsZW1lbnQuY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghIXNpZ25hbGVtZW50Lmhhc01ldGEpXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaG93RGV0YWlscyhzaWduYWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmN1cnJlbnRQb2ludCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBfdGhpcy5tYXAucG9pbnRMaXN0LnB1c2goc2lnbmFsZW1lbnQpO1xuICAgICAgICAgICAgICAgIF90aGlzLiRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFJlZ2llQ3RybC5wcm90b3R5cGUuc2hvd0RldGFpbHMgPSBmdW5jdGlvbiAocG9pbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLlJlZ2llU2VydmljZS5yZXNvdXJjZSgpLmdldCh7IGlkOiBwb2ludC5pZCB9KS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuVXNlclNlcnZpY2UuZ2V0KHsgaWQ6IGRhdGEudXNlcmlkIH0pLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHVzZXJEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEudXRpbGlzYXRldXIgPSB1c2VyRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY3VycmVudFBvaW50ID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzLmN1cnJlbnRQb2ludCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5jdXJyZW50UG9pbnQgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy4kc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBSZWdpZUN0cmw7XG4gICAgfSgpKTtcbiAgICBBeGFTYWZlQ29udHJvbGxlcnMuUmVnaWVDdHJsID0gUmVnaWVDdHJsO1xufSkoQXhhU2FmZUNvbnRyb2xsZXJzIHx8IChBeGFTYWZlQ29udHJvbGxlcnMgPSB7fSkpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==
